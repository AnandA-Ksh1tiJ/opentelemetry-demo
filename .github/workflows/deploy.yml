name: Trigger OpenTelemetry Docker Build

on:
  push:
    branches:
      - main  # Adjust this to the branch you want to trigger the workflow on
    paths:
      - '**/Dockerfile'  # Triggers on changes to Dockerfile files
  pull_request:
    branches:
      - main  # Adjust this to the branch you want to trigger the workflow on
    paths:
      - '**/Dockerfile'  # Triggers on changes to Dockerfile files
  workflow_dispatch:  # Manual trigger option from the GitHub UI
    inputs:
      push:
        description: 'Should the images be pushed'
        required: false
        default: false
        type: boolean
      version:
        description: 'The version used when tagging the image'
        required: false
        default: 'dev'
        type: string
      dockerhub_repo:
        description: 'Docker Hub repository'
        required: false
        default: 'otel/demo'
        type: string
      ghcr_repo:
        description: 'GHCR repository'
        required: false
        default: 'ghcr.io/open-telemetry/demo'
        type: string

jobs:
  call-opentelemetry-build:
    uses: 'component-build-images.yml'  # Path to your original OpenTelemetry build workflow
    with:
      push: ${{ github.event.inputs.push }}
      version: ${{ github.event.inputs.version }}
      dockerhub_repo: ${{ github.event.inputs.dockerhub_repo }}
      ghcr_repo: ${{ github.event.inputs.ghcr_repo }}
